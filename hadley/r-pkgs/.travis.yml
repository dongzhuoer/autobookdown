# I use global env to facilitate debug, since they exist as soon as you enter the shell
dist: xenial
language: minimal
git:
  depth: false
  submodules: false
cache: 
  # `Whole-game.Rmd` would produce error which knitr tells _wrong_ location, if you cache `$TRAVIS_BUILD_DIR/_bookdown_files/`
  directories: [$HOME/.local/lib/R/]
env:
  global: 
    - input_git=https://github.com/hadley/r-pkgs.git
    - repo_git="-b hadley-r-pkgs https://$GITHUB_PAT@github.com/dongzhuoer/bookdown.dongzhuoer.com.git"
    - rmd_dir=.
    - root_command="apt update && apt install -y pandoc-citeproc && chown -R $USER:$USER /home/travis"
    - user_command="touch $HOME/.gitconfig && git config --global user.name Travis && git config --global user.email travis@example.com"
    - install_pkg="remotes::update_packages(c('bookdown', 'devtools', 'fs', 'lubridate', 'nycflights13', 'pryr', 'rlang', 'roxygen2', 'stringi', 'testthat', 'tidyverse', 'withr'))"
    - render_args=""
    - zhuoerdown=true # build other's bookdown, several links would be added to TOC
    - custom_yaml="$TRAVIS_BUILD_DIR/_output.yaml"  
    - url=https://r-pkgs.org/

script: wget https://raw.githubusercontent.com/dongzhuoer/zhuoerdown/master/inst/travis-script.sh && bash travis-script.sh

notifications:
  email: false
